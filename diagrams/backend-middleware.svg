<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="956px" preserveAspectRatio="none" style="width:589px;height:956px;" version="1.1" viewBox="0 0 589 956" width="589px" zoomAndPan="magnify"><defs><filter height="300%" id="fvqt7s8h0h495" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="296" cy="20" fill="#000000" filter="url(#fvqt7s8h0h495)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="193" x="199.5" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="30" x="209.5" y="71.6016">Read</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="98" x="243.5" y="71.6016">xing_csrf_token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="37" x="345.5" y="71.6016">cookie</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="219" x="186.5" y="104.1328"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="30" x="196.5" y="125.7344">Read</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="230.5" y="125.7344">xing_csrf_checksum</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="37" x="358.5" y="125.7344">cookie</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="253" x="169.5" y="158.2656"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="233" x="179.5" y="179.8672">Validate the token against the checksum</text><polygon fill="#FEFECE" filter="url(#fvqt7s8h0h495)" points="257,212.3984,335,212.3984,347,224.3984,335,236.3984,257,236.3984,245,224.3984,257,212.3984" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="257" y="228.5557">Token is valid?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="227" y="222.0781">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="347" y="222.0781">no</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="278" x="10" y="246.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="168" x="20" y="268">Save the existing token in the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="192" y="268">token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="232" y="268">variable</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="275" x="11.5" y="300.5313"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="17" x="21.5" y="322.1328">Set</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="42.5" y="322.1328">new_token_generated</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="61" x="181.5" y="322.1328">variable to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="246.5" y="322.1328">false</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="375" y="246.3984"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="116" x="385" y="268">Generate new token</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="257" x="314.5" y="300.5313"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="147" x="324.5" y="322.1328">Save the new token in the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="475.5" y="322.1328">token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="515.5" y="322.1328">variable</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="270" x="308" y="354.6641"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="17" x="318" y="376.2656">Set</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="135" x="339" y="376.2656">new_token_generated</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="61" x="478" y="376.2656">variable to</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="543" y="376.2656">true</text><polygon fill="#FEFECE" filter="url(#fvqt7s8h0h495)" points="296,394.7969,308,406.7969,296,418.7969,284,406.7969,296,394.7969" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="247" x="172.5" y="438.7969"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="137" x="182.5" y="460.3984">Call the application with</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="323.5" y="460.3984">token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="363.5" y="460.3984">variable</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="196" x="198" y="492.9297"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="208" y="514.5313">Save the application</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="327" y="514.5313">response</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="200.5" y="595.54"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="171" x="210.5" y="617.1416">Compute the token checksum</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="267" x="162.5" y="649.6729"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="172.5" y="671.2744">Append the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="244.5" y="671.2744">token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="284.5" y="671.2744">cookie to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="362.5" y="671.2744">response</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="293" x="149.5" y="718.8057"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="68" x="159.5" y="740.4072">Append the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="231.5" y="740.4072">checksum</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="297.5" y="740.4072">cookie to the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="375.5" y="740.4072">response</text><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="165" x="213.5" y="772.9385"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="105" x="223.5" y="794.54">Log the generated</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="332.5" y="794.54">token</text><polygon fill="#FEFECE" filter="url(#fvqt7s8h0h495)" points="180.5,547.0625,411.5,547.0625,423.5,559.0625,411.5,571.0625,180.5,571.0625,168.5,559.0625,180.5,547.0625" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="300" y="581.6973">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="180.5" y="563.2197">"new_token_generated" flag is set to "true"?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="423.5" y="556.7422">no</text><polygon fill="#FEFECE" filter="url(#fvqt7s8h0h495)" points="296,827.0713,308,839.0713,296,851.0713,284,839.0713,296,827.0713" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fvqt7s8h0h495)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="119" x="236.5" y="871.0713"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="38" x="246.5" y="892.6729">Return</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="288.5" y="892.6729">response</text><ellipse cx="296" cy="935.2041" fill="none" filter="url(#fvqt7s8h0h495)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="296.5" cy="935.7041" fill="#000000" filter="url(#fvqt7s8h0h495)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="30" y2="50"/><polygon fill="#A80036" points="292,40,296,50,300,40,296,44" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="84.1328" y2="104.1328"/><polygon fill="#A80036" points="292,94.1328,296,104.1328,300,94.1328,296,98.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="138.2656" y2="158.2656"/><polygon fill="#A80036" points="292,148.2656,296,158.2656,300,148.2656,296,152.2656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="149" x2="149" y1="280.5313" y2="300.5313"/><polygon fill="#A80036" points="145,290.5313,149,300.5313,153,290.5313,149,294.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443" x2="443" y1="280.5313" y2="300.5313"/><polygon fill="#A80036" points="439,290.5313,443,300.5313,447,290.5313,443,294.5313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443" x2="443" y1="334.6641" y2="354.6641"/><polygon fill="#A80036" points="439,344.6641,443,354.6641,447,344.6641,443,348.6641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="245" x2="149" y1="224.3984" y2="224.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="149" x2="149" y1="224.3984" y2="246.3984"/><polygon fill="#A80036" points="145,236.3984,149,246.3984,153,236.3984,149,240.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="347" x2="443" y1="224.3984" y2="224.3984"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443" x2="443" y1="224.3984" y2="246.3984"/><polygon fill="#A80036" points="439,236.3984,443,246.3984,447,236.3984,443,240.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="149" x2="149" y1="334.6641" y2="406.7969"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="149" x2="284" y1="406.7969" y2="406.7969"/><polygon fill="#A80036" points="274,402.7969,284,406.7969,274,410.7969,278,406.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443" x2="443" y1="388.7969" y2="406.7969"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443" x2="308" y1="406.7969" y2="406.7969"/><polygon fill="#A80036" points="318,402.7969,308,406.7969,318,410.7969,314,406.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="192.3984" y2="212.3984"/><polygon fill="#A80036" points="292,202.3984,296,212.3984,300,202.3984,296,206.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="418.7969" y2="438.7969"/><polygon fill="#A80036" points="292,428.7969,296,438.7969,300,428.7969,296,432.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="472.9297" y2="492.9297"/><polygon fill="#A80036" points="292,482.9297,296,492.9297,300,482.9297,296,486.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="629.6729" y2="649.6729"/><polygon fill="#A80036" points="292,639.6729,296,649.6729,300,639.6729,296,643.6729" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="683.8057" y2="718.8057"/><polygon fill="#A80036" points="292,708.8057,296,718.8057,300,708.8057,296,712.8057" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="752.9385" y2="772.9385"/><polygon fill="#A80036" points="292,762.9385,296,772.9385,300,762.9385,296,766.9385" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="571.0625" y2="595.54"/><polygon fill="#A80036" points="292,585.54,296,595.54,300,585.54,296,589.54" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="423.5" x2="452.5" y1="559.0625" y2="559.0625"/><polygon fill="#A80036" points="448.5,691.3057,452.5,701.3057,456.5,691.3057,452.5,695.3057" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="452.5" x2="452.5" y1="559.0625" y2="839.0713"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="452.5" x2="308" y1="839.0713" y2="839.0713"/><polygon fill="#A80036" points="318,835.0713,308,839.0713,318,843.0713,314,839.0713" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="807.0713" y2="827.0713"/><polygon fill="#A80036" points="292,817.0713,296,827.0713,300,817.0713,296,821.0713" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="527.0625" y2="547.0625"/><polygon fill="#A80036" points="292,537.0625,296,547.0625,300,537.0625,296,541.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="851.0713" y2="871.0713"/><polygon fill="#A80036" points="292,861.0713,296,871.0713,300,861.0713,296,865.0713" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="296" x2="296" y1="905.2041" y2="925.2041"/><polygon fill="#A80036" points="292,915.2041,296,925.2041,300,915.2041,296,919.2041" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
start

:Read **xing_csrf_token** cookie;
:Read **xing_csrf_checksum** cookie;
:Validate the token against the checksum;

if (Token is valid?) then (yes)
    :Save the existing token in the **token** variable;
    :Set **new_token_generated** variable to **false**;
else (no)
    :Generate new token;
    :Save the new token in the **token** variable;
    :Set **new_token_generated** variable to **true**;
endif

:Call the application with **token** variable;
:Save the application **response**;

if ("new_token_generated" flag is set to "true"?) then (yes)
    :Compute the token checksum;
    :Append the **token** cookie to the **response**;
    :Append the **checksum** cookie to the **response**;
    :Log the generated **token**;
else (no)
endif


:Return **response**;

stop
@enduml

PlantUML version 1.2018.06(Mon May 21 12:34:53 CEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_121-b13
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>