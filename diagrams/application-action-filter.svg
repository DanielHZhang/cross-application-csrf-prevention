<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="508px" preserveAspectRatio="none" style="width:478px;height:508px;" version="1.1" viewBox="0 0 478 508" width="478px" zoomAndPan="magnify"><defs><filter height="300%" id="f1rw04q4uu7le" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="200.5" cy="20" fill="#000000" filter="url(#f1rw04q4uu7le)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1rw04q4uu7le)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="381" x="10" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="20" y="71.6016">Read the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="76" y="71.6016">token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="116" y="71.6016">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="116" x="169" y="71.6016">authenticity_token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="92" x="289" y="71.6016">form parameter</text><rect fill="#FEFECE" filter="url(#f1rw04q4uu7le)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="308" x="46.5" y="152.6104"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="56.5" y="174.2119">Read the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="112.5" y="174.2119">token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="152.5" y="174.2119">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="205.5" y="174.2119">X-CSRF-Token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="41" x="303.5" y="174.2119">header</text><polygon fill="#FEFECE" filter="url(#f1rw04q4uu7le)" points="155,104.1328,246,104.1328,258,116.1328,246,128.1328,155,128.1328,143,116.1328,155,104.1328" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="204.5" y="138.7676">no</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="155" y="120.29">token</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="57" x="189" y="120.29">is defined?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="258" y="113.8125">yes</text><polygon fill="#FEFECE" filter="url(#f1rw04q4uu7le)" points="200.5,206.7432,212.5,218.7432,200.5,230.7432,188.5,218.7432,200.5,206.7432" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1rw04q4uu7le)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="360" x="20.5" y="250.7432"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="30.5" y="272.3447">Read the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="86.5" y="272.3447">checksum</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="152.5" y="272.3447">from the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="124" x="205.5" y="272.3447">xing_csrf_checksum</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="37" x="333.5" y="272.3447">cookie</text><rect fill="#FEFECE" filter="url(#f1rw04q4uu7le)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="262" x="69.5" y="304.876"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="79.5" y="326.4775">Validate the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="36" x="152.5" y="326.4775">token</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="63" x="192.5" y="326.4775">against the</text><text fill="#000000" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="259.5" y="326.4775">checksum</text><polygon fill="#FEFECE" filter="url(#f1rw04q4uu7le)" points="162.5,359.0088,238.5,359.0088,250.5,371.0088,238.5,383.0088,162.5,383.0088,150.5,371.0088,162.5,359.0088" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="31" x="162.5" y="375.166">token</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="196.5" y="375.166">is valid?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="132.5" y="368.6885">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="250.5" y="368.6885">no</text><rect fill="#FEFECE" filter="url(#f1rw04q4uu7le)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="135" x="14.75" y="393.0088"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="24.75" y="414.6104">Execute the request</text><rect fill="#FEFECE" filter="url(#f1rw04q4uu7le)" height="34.1328" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="298" x="169.75" y="393.0088"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="278" x="179.75" y="414.6104">Respond with backend error (400 Bad Request)</text><polygon fill="#FEFECE" filter="url(#f1rw04q4uu7le)" points="200.5,433.1416,212.5,445.1416,200.5,457.1416,188.5,445.1416,200.5,433.1416" style="stroke: #A80036; stroke-width: 1.5;"/><ellipse cx="200.5" cy="487.1416" fill="none" filter="url(#f1rw04q4uu7le)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="201" cy="487.6416" fill="#000000" filter="url(#f1rw04q4uu7le)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="30" y2="50"/><polygon fill="#A80036" points="196.5,40,200.5,50,204.5,40,200.5,44" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="128.1328" y2="152.6104"/><polygon fill="#A80036" points="196.5,142.6104,200.5,152.6104,204.5,142.6104,200.5,146.6104" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="258" x2="364.5" y1="116.1328" y2="116.1328"/><polygon fill="#A80036" points="360.5,159.6768,364.5,169.6768,368.5,159.6768,364.5,163.6768" style="stroke: #A80036; stroke-width: 1.5;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="364.5" x2="364.5" y1="116.1328" y2="218.7432"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="364.5" x2="212.5" y1="218.7432" y2="218.7432"/><polygon fill="#A80036" points="222.5,214.7432,212.5,218.7432,222.5,222.7432,218.5,218.7432" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="186.7432" y2="206.7432"/><polygon fill="#A80036" points="196.5,196.7432,200.5,206.7432,204.5,196.7432,200.5,200.7432" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="84.1328" y2="104.1328"/><polygon fill="#A80036" points="196.5,94.1328,200.5,104.1328,204.5,94.1328,200.5,98.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="230.7432" y2="250.7432"/><polygon fill="#A80036" points="196.5,240.7432,200.5,250.7432,204.5,240.7432,200.5,244.7432" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="284.876" y2="304.876"/><polygon fill="#A80036" points="196.5,294.876,200.5,304.876,204.5,294.876,200.5,298.876" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="150.5" x2="82.25" y1="371.0088" y2="371.0088"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="82.25" x2="82.25" y1="371.0088" y2="393.0088"/><polygon fill="#A80036" points="78.25,383.0088,82.25,393.0088,86.25,383.0088,82.25,387.0088" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="250.5" x2="318.75" y1="371.0088" y2="371.0088"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="318.75" x2="318.75" y1="371.0088" y2="393.0088"/><polygon fill="#A80036" points="314.75,383.0088,318.75,393.0088,322.75,383.0088,318.75,387.0088" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="82.25" x2="82.25" y1="427.1416" y2="445.1416"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="82.25" x2="188.5" y1="445.1416" y2="445.1416"/><polygon fill="#A80036" points="178.5,441.1416,188.5,445.1416,178.5,449.1416,182.5,445.1416" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="318.75" x2="318.75" y1="427.1416" y2="445.1416"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="318.75" x2="212.5" y1="445.1416" y2="445.1416"/><polygon fill="#A80036" points="222.5,441.1416,212.5,445.1416,222.5,449.1416,218.5,445.1416" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="339.0088" y2="359.0088"/><polygon fill="#A80036" points="196.5,349.0088,200.5,359.0088,204.5,349.0088,200.5,353.0088" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="200.5" x2="200.5" y1="457.1416" y2="477.1416"/><polygon fill="#A80036" points="196.5,467.1416,200.5,477.1416,204.5,467.1416,200.5,471.1416" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
start

:Read the **token** from the **authenticity_token** form parameter;

if (**token** is defined?) then (yes)
else (no)
    :Read the **token** from the **X-CSRF-Token** header;
endif

:Read the **checksum** from the **xing_csrf_checksum** cookie;
:Validate the **token** against the **checksum**;

if (**token** is valid?) then (yes)
    :Execute the request;
else (no)
    :Respond with backend error (400 Bad Request);
endif

stop
@enduml

PlantUML version 1.2018.06(Mon May 21 12:34:53 CEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_121-b13
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>