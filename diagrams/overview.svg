<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1132px" preserveAspectRatio="none" style="width:808px;height:1132px;" version="1.1" viewBox="0 0 808 1132" width="808px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mhxr7b0v5rfu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="736.4766" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="150.5" y="290.3516"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="172.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="303.5" y="117.7988"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="303.5" y="407.5938"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="439.6816" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="303.5" y="508.5254"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="71.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="147.1094"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="381.0605" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="537.8359"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="318.75" style="stroke: #000000; stroke-width: 2.0;" width="678.5" x="105" y="679.7676"/><rect fill="#FFFFFF" height="200.5078" style="stroke: none; stroke-width: 1.0;" width="678.5" x="105" y="798.0098"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="26" x2="26" y1="86.4883" y2="1044.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="155" x2="155" y1="86.4883" y2="1044.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="308" x2="308" y1="86.4883" y2="1044.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="552" x2="552" y1="86.4883" y2="1044.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="8" y="83.5352">User</text><ellipse cx="26.5" cy="13" fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M26.5,21 L26.5,48 M13.5,29 L39.5,29 M26.5,48 L13.5,63 M26.5,48 L39.5,63 " fill="none" filter="url(#f1mhxr7b0v5rfu)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="8" y="1057.3633">User</text><ellipse cx="26.5" cy="1070.3164" fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M26.5,1078.3164 L26.5,1105.3164 M13.5,1086.3164 L39.5,1086.3164 M26.5,1105.3164 L13.5,1120.3164 M26.5,1105.3164 L39.5,1120.3164 " fill="none" filter="url(#f1mhxr7b0v5rfu)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="115" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="122" y="71.5352">Frontend</text><rect fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="77" x="115" y="1043.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="122" y="1064.3633">Frontend</text><rect fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="272" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="279" y="71.5352">Browser</text><rect fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="272" y="1043.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="55" x="279" y="1064.3633">Browser</text><rect fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="515" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="522" y="71.5352">Backend</text><rect fill="#FEFECE" filter="url(#f1mhxr7b0v5rfu)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="515" y="1043.8281"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="522" y="1064.3633">Backend</text><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="736.4766" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="150.5" y="290.3516"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="172.5527" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="303.5" y="117.7988"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="29.3105" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="303.5" y="407.5938"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="439.6816" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="303.5" y="508.5254"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="71.6211" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="147.1094"/><rect fill="#FFFFFF" filter="url(#f1mhxr7b0v5rfu)" height="381.0605" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="547.5" y="537.8359"/><polygon fill="#A80036" points="291.5,113.7988,301.5,117.7988,291.5,121.7988,295.5,117.7988" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26.5" x2="297.5" y1="117.7988" y2="117.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="74" x="33.5" y="113.0566">Open /page</text><polygon fill="#A80036" points="535.5,143.1094,545.5,147.1094,535.5,151.1094,539.5,147.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="313.5" x2="541.5" y1="147.1094" y2="147.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="320.5" y="142.3672">GET /page</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="176.4199" y2="176.4199"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="176.4199" y2="189.4199"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="189.4199" y2="189.4199"/><polygon fill="#A80036" points="568.5,185.4199,558.5,189.4199,568.5,193.4199,564.5,189.4199" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="564.5" y="171.6777">Set token and checksum cookies</text><polygon fill="#A80036" points="324.5,214.7305,314.5,218.7305,324.5,222.7305,320.5,218.7305" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="318.5" x2="551.5" y1="218.7305" y2="218.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="46" x="330.5" y="213.9883">200 OK</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="313.5" x2="355.5" y1="248.041" y2="248.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355.5" x2="355.5" y1="248.041" y2="261.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="355.5" y1="261.041" y2="261.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="324.5" y1="261.041" y2="257.041"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="314.5" x2="324.5" y1="261.041" y2="265.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="220" x="320.5" y="243.2988">Store token and checksum cookies</text><polygon fill="#A80036" points="171.5,286.3516,161.5,290.3516,171.5,294.3516,167.5,290.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="165.5" x2="307.5" y1="290.3516" y2="290.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="177.5" y="285.6094">Render</text><polygon fill="#A80036" points="37.5,315.6621,27.5,319.6621,37.5,323.6621,33.5,319.6621" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="31.5" x2="149.5" y1="319.6621" y2="319.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="37" x="43.5" y="314.9199">Ready</text><polygon fill="#A80036" points="138.5,344.9727,148.5,348.9727,138.5,352.9727,142.5,348.9727" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26.5" x2="144.5" y1="348.9727" y2="348.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="33.5" y="344.2305">Fill in form data</text><polygon fill="#A80036" points="138.5,374.2832,148.5,378.2832,138.5,382.2832,142.5,378.2832" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="26.5" x2="144.5" y1="378.2832" y2="378.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="33.5" y="373.541">Save the form</text><polygon fill="#A80036" points="291.5,403.5938,301.5,407.5938,291.5,411.5938,295.5,407.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="160.5" x2="297.5" y1="407.5938" y2="407.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="167.5" y="402.8516">Get token cookie</text><polygon fill="#A80036" points="171.5,432.9043,161.5,436.9043,171.5,440.9043,167.5,436.9043" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="165.5" x2="307.5" y1="436.9043" y2="436.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="177.5" y="432.1621">Token</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="160.5" x2="202.5" y1="466.2148" y2="466.2148"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="202.5" y1="466.2148" y2="479.2148"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="161.5" x2="202.5" y1="479.2148" y2="479.2148"/><polygon fill="#A80036" points="171.5,475.2148,161.5,479.2148,171.5,483.2148,167.5,479.2148" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="167.5" y="461.4727">Set the token header</text><polygon fill="#A80036" points="291.5,504.5254,301.5,508.5254,291.5,512.5254,295.5,508.5254" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="160.5" x2="297.5" y1="508.5254" y2="508.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="167.5" y="503.7832">Send the request</text><polygon fill="#A80036" points="535.5,533.8359,545.5,537.8359,535.5,541.8359,539.5,537.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="313.5" x2="541.5" y1="537.8359" y2="537.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="320.5" y="533.0938">POST /save_form</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="567.1465" y2="567.1465"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="567.1465" y2="580.1465"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="580.1465" y2="580.1465"/><polygon fill="#A80036" points="568.5,576.1465,558.5,580.1465,568.5,584.1465,564.5,580.1465" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="564.5" y="562.4043">Read the token header</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="609.457" y2="609.457"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="609.457" y2="622.457"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="622.457" y2="622.457"/><polygon fill="#A80036" points="568.5,618.457,558.5,622.457,568.5,626.457,564.5,622.457" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="564.5" y="604.7148">Read the checksum cookie</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="651.7676" y2="651.7676"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="651.7676" y2="664.7676"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="664.7676" y2="664.7676"/><polygon fill="#A80036" points="568.5,660.7676,558.5,664.7676,568.5,668.7676,564.5,664.7676" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="232" x="564.5" y="647.0254">Validate the token against checksum</text><path d="M105,679.7676 L167,679.7676 L167,686.7676 L157,696.7676 L105,696.7676 L105,679.7676 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="318.75" style="stroke: #000000; stroke-width: 2.0;" width="678.5" x="105" y="679.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="17" x="120" y="693.3359">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="182" y="692.4023">[Valid token]</text><polygon fill="#A80036" points="324.5,714.3887,314.5,718.3887,324.5,722.3887,320.5,718.3887" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="318.5" x2="546.5" y1="718.3887" y2="718.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="330.5" y="713.6465">204 No Content</text><polygon fill="#A80036" points="171.5,743.6992,161.5,747.6992,171.5,751.6992,167.5,747.6992" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="165.5" x2="302.5" y1="747.6992" y2="747.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="50" x="177.5" y="742.957">Success</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="160.5" x2="202.5" y1="777.0098" y2="777.0098"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="202.5" y1="777.0098" y2="790.0098"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="161.5" x2="202.5" y1="790.0098" y2="790.0098"/><polygon fill="#A80036" points="171.5,786.0098,161.5,790.0098,171.5,794.0098,167.5,790.0098" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="97" x="167.5" y="772.2676">Render success</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="105" x2="783.5" y1="799.0098" y2="799.0098"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="110" y="809.6445">[Invalid token]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="834.2754" y2="834.2754"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="834.2754" y2="847.2754"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="847.2754" y2="847.2754"/><polygon fill="#A80036" points="568.5,843.2754,558.5,847.2754,568.5,851.2754,564.5,847.2754" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="564.5" y="829.5332">Generate new token</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="557.5" x2="599.5" y1="876.5859" y2="876.5859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="599.5" x2="599.5" y1="876.5859" y2="889.5859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558.5" x2="599.5" y1="889.5859" y2="889.5859"/><polygon fill="#A80036" points="568.5,885.5859,558.5,889.5859,568.5,893.5859,564.5,889.5859" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="564.5" y="871.8438">Set token and checksum cookies</text><polygon fill="#A80036" points="324.5,914.8965,314.5,918.8965,324.5,922.8965,320.5,918.8965" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="318.5" x2="551.5" y1="918.8965" y2="918.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="330.5" y="914.1543">400 Bad Request</text><polygon fill="#A80036" points="171.5,944.207,161.5,948.207,171.5,952.207,167.5,948.207" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="165.5" x2="307.5" y1="948.207" y2="948.207"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="177.5" y="943.4648">Error</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="160.5" x2="202.5" y1="977.5176" y2="977.5176"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="202.5" x2="202.5" y1="977.5176" y2="990.5176"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="161.5" x2="202.5" y1="990.5176" y2="990.5176"/><polygon fill="#A80036" points="171.5,986.5176,161.5,990.5176,171.5,994.5176,167.5,990.5176" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="167.5" y="972.7754">Render error</text><polygon fill="#A80036" points="37.5,1022.8281,27.5,1026.8281,37.5,1030.8281,33.5,1026.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="31.5" x2="154.5" y1="1026.8281" y2="1026.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="33" x="43.5" y="1022.0859">Done</text><!--
@startuml
actor User
participant Frontend
participant Browser
participant Backend

User -> Browser: Open /page
activate Browser

Browser -> Backend: GET /page
activate Backend

Backend -> Backend: Set token and checksum cookies

Backend - -> Browser: 200 OK
deactivate Backend

Browser ->> Browser: Store token and checksum cookies

Browser - -> Frontend: Render
deactivate Browser

activate Frontend

Frontend - -> User: Ready


User -> Frontend: Fill in form data

User -> Frontend: Save the form

Frontend -> Browser: Get token cookie
activate Browser
Browser -> Frontend: Token
deactivate Browser
Frontend -> Frontend: Set the token header

Frontend -> Browser: Send the request
activate Browser
Browser -> Backend: POST /save_form

activate Backend
Backend -> Backend: Read the token header
Backend -> Backend: Read the checksum cookie
Backend -> Backend: Validate the token against checksum

alt Valid token
    Backend - -> Browser: 204 No Content
    Browser - -> Frontend: Success
    Frontend -> Frontend: Render success
else Invalid token
    Backend -> Backend: Generate new token
    Backend -> Backend: Set token and checksum cookies
    Backend - -> Browser: 400 Bad Request
    deactivate Backend
    Browser - -> Frontend: Error
    deactivate Browser
    Frontend -> Frontend: Render error
end

Frontend - -> User: Done
deactivate Frontend
@enduml

PlantUML version 1.2018.06(Mon May 21 12:34:53 CEST 2018)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.8.0_121-b13
Operating System: Mac OS X
OS Version: 10.13.4
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>